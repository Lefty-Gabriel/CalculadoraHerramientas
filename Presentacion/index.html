<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Sistema de Productos</title>
</head>
<body>

    <h1>Ingreso de Productos</h1>

    <input id="nombre" placeholder="Nombre del producto">
    <input id="precio" type="number" placeholder="Precio">
    <button onclick="guardar()">Guardar</button>

    <h2>Productos guardados</h2>
    <ul id="lista"></ul>

    <script>
        async function guardar() {
            const nombre = document.getElementById('nombre').value;
            const precio = parseFloat(document.getElementById('precio').value);

            const res = await fetch('/api/productos', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ nombre, precio })
            });

            await cargarLista();
        }

        async function cargarLista() {
            const res = await fetch('/api/productos');
            const productos = await res.json();

            const ul = document.getElementById("lista");
            ul.innerHTML = "";

            productos.forEach(p => {
                const li = document.createElement("li");
                li.textContent = `${p.nombre} - Subtotal: ${p.subtotal}, IVA: ${p.iva}, Total: ${p.total}`;
                ul.appendChild(li);
            });
        }

        cargarLista();
    </script>

</body>
</html>
